const u=navigator.userAgent,isAndroid=-1<u.indexOf("Android")||-1<u.indexOf("Adr"),isIOS=!!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),isWX="micromessenger"==u.toLowerCase().match(/MicroMessenger/i),andoirFunction=e=>{window.WebViewJavascriptBridge?e(window.WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){e(window.WebViewJavascriptBridge)},!1)},iosFuntion=e=>{return window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):window.WVJBCallbacks?window.WVJBCallbacks.push(e):(window.WVJBCallbacks=[e],void(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.iOS_Native_InjectJavascript?window.webkit.messageHandlers.iOS_Native_InjectJavascript.postMessage(null):(window.WVJBCallbacks=[e],(i=document.createElement("iframe")).style.display="none",i.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(i),setTimeout(function(){document.documentElement.removeChild(i)},0))));var i},TIME_OUT=(window.setupWebViewJavascriptBridge=isAndroid?andoirFunction:iosFuntion,isWX||(isAndroid?window.setupWebViewJavascriptBridge(function(e){e.init(function(e,i){i(e)})}):window.setupWebViewJavascriptBridge()),2e3);function wbBridgeSetup(i,n){window.setupWebViewJavascriptBridge(e=>{e.registerHandler(i,(e="")=>{try{e=JSON.parse(e)}catch(e){}n&&n(e)})})}function toJson(e){return e=e&&"string"!=typeof e?JSON.stringify(e):e}function appBridge(o,r,t=TIME_OUT){let a=!0;const e={version:"2.1.1"}["version"];var i=+e.replace(/\./g,"");return console.log(1111,i),(211<=i||!isIOS)&&(r=toJson(r)),new Promise((i,e)=>{const n=e=>{console.error("=====>",e);try{e=JSON.parse(e)}catch(e){}return a=!1,console.info(`app指令${o}返回`,e),i(e)};window.setupWebViewJavascriptBridge(e=>{console.warn("调取app指令",o,r),e.callHandler(o,r,n)}),t&&setTimeout(()=>{a&&i()},t)})}function popSocialMenu(e){return appBridge("pop_social_menu",e)}window.app=(i,n)=>{window.setupWebViewJavascriptBridge(e=>{console.warn("调取app指令",i,n),e.callHandler(i,n,e=>{try{e=JSON.parse(e)}catch(e){}console.error("返回数据 ===>",e)})})},function(e){e.command={popSocialMenu:popSocialMenu}}(this);